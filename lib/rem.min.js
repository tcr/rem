var d=null,g="undefined"==typeof require?this.$={}:exports;g.H=function(a){return JSON.parse(JSON.stringify(a))};g.modify=function(a,b){var c=g.H(a),e;for(e in a)Object.prototype.hasOwnProperty.call(a,e)&&(c[e]=a[e]);for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(c[e]=b[e]);return c};g.G=function(a){function b(){return b.call.apply(b,arguments)}b.__proto__=a;return b};g.O=function(a){return JSON.stringify(a).replace(/[\u007f-\uffff]/g,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})};
g.B=function(a,b){a.aa=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1}})};g.o=d;function i(){}function j(a,b){return a.hasOwnProperty.call(a.n||(a.n={}),b)?a.n[b]:a.n[b]=[]}i.prototype.j=i.prototype.addListener=function(a,b){0!==this.D&&j(this,a).push(b)>(this.D||10)&&console&&console.warn("Possible EventEmitter memory leak detected. "+this.n[a].length+" listeners added. Use emitter.setMaxListeners() to increase limit.");this.p("newListener",a,b);return this};
i.prototype.p=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=0,e=j(this,a).slice();c<e.length;c++)e[c].apply(this,b)};g.R=i;g.url={parse:d,d:d,host:function(a){return a.hostname&&a.hostname+(a.port?":"+a.port:"")},path:function(a){return a.pathname+(a.b?"?"+g.f.stringify(a.b):"")+(a.hash?"#"+encodeURIComponent(a.hash):"")}};
g.c={create:function(a){return g.c.url({method:"GET",headers:{},url:d,body:d},a)},url:function(a,b){"string"==typeof b&&(b=g.url.parse(b));b.b=g.modify(a.url?a.url.b:{},b.b);a=g.modify(a,{url:a.url?g.modify(a.url,b):b});return g.modify(a,{headers:g.modify(a.headers,{Host:g.url.host(a.url)})})},body:function(a,b,c){if("object"==typeof c){if("form"==b||"application/x-www-form-urlencoded"==b)b="application/x-www-form-urlencoded",c=g.f.stringify(c);if("json"==b||"application/json"==b)b="application/json",
c=g.O(c)}return g.modify(a,{headers:g.modify(a.headers,{"Content-Type":b,"Content-Length":c.length}),body:c})},send:d};g.f={stringify:d,parse:d};g.path={join:d};g.K=function(a){var b=require("fs"),c=require("path");try{return JSON.parse(b.Y(c.join(__dirname,"../builtin",a+".json")))}catch(e){return d}};
if("undefined"!=typeof require){g.o=function(a,b){var c=[];a.j("data",function(a){c.push(a)});a.j("end",function(){b(Buffer.concat(c))})};var l=require("url");g.url.parse=function(a){a=l.parse(String(a),!0);return{protocol:a.protocol,i:a.i,hostname:a.hostname,port:a.port,pathname:a.pathname,b:a.b||{},search:a.search,hash:a.hash}};g.url.d=function(a){return l.d(a)};var n=require("http"),o=require("https");require("querystring");g.c.send=function(a,b){var c=("https:"==a.url.protocol?o:n).c({method:a.method,
headers:a.headers,protocol:a.url.protocol,hostname:a.url.hostname,port:a.url.port,path:g.url.path(a.url)});c.j("response",function(c){3==(c.g/100|0)&&c.headers.location?g.c.send(g.c.url(a,c.headers.location),b):b&&b(d,c)});a.body!=d&&c.write(a.body);c.end();return c};g.f=require("querystring");g.path=require("path")}
if("undefined"==typeof require){var q=function(a){var b=0;this.statusText=a.statusText;this.g=a.status;a.onreadystatechange=function(){3==a.readyState&&(this.p("data",a.responseText.substr(b)),b=a.responseText.length);4==a.readyState&&(b<a.responseText.length&&this.p("data",a.responseText.substr(b)),this.p("end"))}.bind(this)};g.o=function(a,b){var c=[];a.j("data",function(a){c.push(a)});a.j("end",function(){b(c.join(""))})};g.url.parse=function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,
i:b.i,hostname:b.hostname,port:b.port,pathname:b.pathname,b:g.f.parse(b.search||""),hash:b.hash&&decodeURIComponent(b.hash.substr(1))}};g.url.d=function(a){var b=document.createElement("a");b.protocol=a.protocol;b.i=a.i;b.hostname=a.hostname;b.port=a.port;b.pathname=a.pathname;b.b=g.f.stringify(a.b);b.hash=a.hash;return b.href};g.f.parse=function(a){for(var b={},a=a.replace(/^\?/,"").replace(/\+/g," ").split("&"),c=0,e=a.length,f;c<e;c++)a[c]&&(f=a[c].split("="),b[decodeURIComponent(f[0])]=decodeURIComponent(f[1]));
return b};g.f.stringify=function(a){var b=[],c;for(c in a)b.push(encodeURIComponent(c)+(a[c]==d?"":"="+encodeURIComponent(a[c])));return b.join("&")};g.B(q,i);g.c.send=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(2==c.readyState){var a=new q(c);b(2!=(c.g/100|0)&&c.g,a)}};var e=["Host","User-Agent","Content-Length"];c.open(a.method,g.url.d(a.url),!0);for(var f in a.headers)-1==e.indexOf(f)&&c.setRequestHeader(f,a.headers[f]);c.send(a.body)};g.path.join=function(){var a=
Array.prototype.slice.call(arguments),b=document.createElement("a");b.href=window.location.href;b.pathname=a.join("/").replace(/\/+/g,"/");return b.pathname.substr(a[0]&&"/"==a[0][0]?0:1)}};var r="undefined"==typeof exports?this.Z={}:exports,g="undefined"==typeof require?g:require("./remutil");r.t="Mozilla/5.0 (compatible; REMbot/1.0; +http://rem.tcr.io/)";r.C=d;
function s(a,b,c){this.S=a;this.N=b;this.data=c;this.type=a.d;this.g=Number(this.N.g);this.A=400<this.g?this.g:0;try{if("xml"===this.type){if(!e)var e=require("libxmljs");this.data=this.xml=e.X(String(this.data))}else this.data=this.J=JSON.parse(String(this.data))}catch(f){this.A=f,console.warn("Could not parse data for type "+this.type+".")}}function t(a,b,c){this.M=a;this.U=b||"json";this.s=c}
t.prototype.get=function(a,b){"function"==typeof a&&(b=a,a=d);return this.s(g.modify(g.c.url(this.M,{b:a||{}}),{method:"GET"}),b)};function u(){}u.prototype.k=function(a){this.h||(this.h={});(this.h.request||(this.h.request=[])).push(a)};u.prototype.s=function(a){var b=Array.prototype.slice.call(arguments,1);(this.h&&this.h[a]||[]).forEach(function(a){a.apply(this,b)}.bind(this));return this};
function v(a,b){this.a=a;this.e=b||{};this.key=this.e.key;this.l=this.e.l;this.d=this.e.d||"json";this.a.r||(this.a.r={J:{}});if(!this.a.r[this.d])throw Error('Format "'+this.d+'" not available. Please specify an available format in the options parameter.');this.a=g.modify(this.a,this.a.r[this.d]);this.k(function(a){a.headers["User-Agent"]=a.headers["User-Agent"]||r.t});this.a.F&&this.k(function(a){a.url.pathname=this.a.F+a.url.pathname});this.a.P&&this.k(function(a){a.url.pathname=a.url.pathname+
this.a.P});this.a.w&&this.k(function(a){var b=this.a.w,f;for(f in b)a.url.b[f]=this.e[this.a.w[f]]});this.a.L&&this.k(function(a){var b=this.a.L,f;for(f in b)a.url.b[f]=b[f]})}g.B(v,u);v.prototype.z=function(a){return a()};
v.prototype.call=function(){var a=Array.prototype.slice.call(arguments),b="object"==typeof a[a.length-1]?a.pop():{},a=g.path.join.apply(d,a);return new t(g.c.create({b:b,pathname:a}),this.a.ba,function(a,b){var f=this;f.z(function(){var m=a.url.pathname.replace(/^(?!\/)/,"/");if(Array.isArray(f.a.v)){var h="";f.a.v.some(function(a){if("string"==typeof a)return h=a,!0;if(m.match(RegExp(a[0])))return h=a[1],!0})}else h=String(f.a.v);a=g.c.url(a,g.url.parse(h));a=g.c.url(a,{pathname:g.path.join(a.url.pathname,
m)});f.s("request",a);f.send(a,function(a,c,h){if(b)return a=new s(f,h,c),b(a.A,a.data,a)})});return a}.bind(this))};v.prototype.send=function(a,b){g.c.send(a,function(a,e){a?b(a,d,e):g.o(e,function(f){b(a,f,e)})})};v.prototype.get=function(){var a=this("");return a.get.apply(a,arguments)};
"undefined"!==typeof require&&(v.prototype.u=!1,v.prototype.q=!1,v.prototype.prompt=function(a){this.q=a||a==d;this.u=!0;return this},v.prototype.z=function(a){var b=require("nconf"),c=require("read"),e=require("cli-color"),f=require("path"),m=r.C||f.join(require("osenv").home(),".rem.json");b.file(m);var h,p,k=this;if(this.key||!this.u||!this.a.id)return a();if(this.q&&b.get(this.a.id)){p=b.get(this.a.id);for(h in p)f=p[h],this.e[h]=f;h=this.e;this.key=h.key;this.l=h.l;return a()}console.log(e.m("Initializing API keys for "+
this.a.id+" on first use."));this.a.I&&console.log(e.m("Register for an API key here:"),this.a.I);return c({prompt:e.m(this.a.id+" API key: ")},function(f,h){k.key=h;k.e.key=h;h||(console.error(e.red("ERROR:"),"No API key specified, aborting."),process.V(1));return c({prompt:e.m(k.a.id+" API secret (if provided): ")},function(c,f){k.l=f;k.e.l=f;if(k.q){b.set(k.a.id+":key",h);b.set(k.a.id+":secret",f);return b.save(function(){console.log(e.m("Your credentials are saved to the configuration file "+
m));console.log(e.m("Edit that file to update or change your credentials.\n"));return a()})}console.log("");return a()})})});r.Q=v;r.create=function(a,b){return g.G(new v(a,b))};r.load=function(a,b,c){var b=b||"1",e=g.K(a);if(!e||!e[b])throw Error("Unable to find API "+a+"::"+b);e=e[b];e.id=a;e.version=b;return r.create(e,c)};
r.url=function(){var a=Array.prototype.slice.call(arguments),b=typeof a[a.length-1]=="object"?a.pop():{},c=g.url.parse(a.shift());c.pathname=g.path.join.apply(d,[c.pathname].concat(a));c.b=b;return new t(g.c.create(c),"form",function(a,b){a.headers["User-Agent"]=a.headers["User-Agent"]||r.t;g.c.send(a,b);return a})};r.T=g.o;"undefined"!=typeof require&&(require("./oauth"),require("./aws"),require("./session"),r.console=r.W);
